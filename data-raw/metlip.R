# metlip.R
# This is meant to be typical of a metlip dataset, although it is simulated - see R/data.R for documentation

# some example lipids with class, Acyl_1, and Acyl_2 designation
example_lipids <- c("PC(14:0_14:0)", "PC(14:0_16:0)", "PC(14:0_18:0)", "PC(16:1_18:0)",  "PC(18:0_18:0)", "PC(14:0_18:1)", "PC(16:1_18:1)", "PC(18:0_18:1)",  "PC(18:1_18:1)", "PC(16:0_18:2)", "PC(18:0_18:2)", "PC(18:1_18:2)",  "PC(18:2_18:2)", "PC(16:0_18:3)", "PC(18:1_20:0)", "PC(18:1_20:1)",  "PC(16:0_20:2)", "PC(18:2_20:2)", "PC(18:0_20:3)", "PC(18:1_20:3)",  "PC(20:1_20:3)", "PC(18:0_20:4)", "PC(18:2_20:4)", "PC(20:1_20:4)",  "PC(20:2_20:4)", "PC(16:0_20:5)", "PC(18:0_20:5)", "PC(16:0_22:4)",  "PC(20:0_22:4)", "PC(18:0_22:5)", "PC(16:0_22:6)", "PC(18:0_22:6)",  "PC(18:1_22:6)", "PC(O-16:0_18:2)", "PC(O-18:0_18:2)", "PC(O-16:0_22:4)",  "PC(O-16:0_22:6)", "PC(P-18:1_16:0)", "PC(P-20:1_20:4)", "PC(P-18:0_22:6)",  "LPC(14:0)", "LPC(15:0)", "LPC(16:0)", "LPC(16:1)", "LPC(18:0)",  "LPC(18:1)", "LPC(18:2)", "LPC(20:0)", "LPC(20:1)", "LPC(20:3)",  "LPC(20:4)", "LPC(22:6)", "LPC(14:0)_2", "LPC(15:0)_2", "LPC(16:0)_2",  "LPC(16:1)_2", "LPC(18:0)_2", "LPC(18:1)_2", "LPC(20:0)_2", "LPC(20:1)_2",  "LPC(20:2)_2", "LPC(20:3)_2", "LPC(20:4)_2", "LPC(22:5)_2", "PE(16:0_18:2)",  "PE(18:0_18:2)", "PE(18:1_18:2)", "PE(18:2_18:2)", "PE(16:0_20:2)",  "PE(18:2_20:2)", "PE(16:0_20:4)", "PE(20:2_20:4)", "PE(16:0_22:4)",  "PE(18:0_22:4)", "PE(18:1_22:4)", "PE(16:0_22:5)", "PE(18:0_22:6)",  "PE(18:2_22:6)", "PE(O-18:0_18:2)", "PE(O-16:0_22:4)", "PE(O-18:0_22:4)",  "PE(P-18:1_20:2)", "PE(P-16:0_20:5)", "PE(P-18:0_20:5)", "PE(P-16:0_22:4)",  "PE(P-18:0_22:4)", "PE(P-18:1_22:4)", "PE(P-20:0_22:4)", "PE(P-20:1_22:4)",  "PE(P-16:0_22:6)", "PE(P-18:0_22:6)", "PE(P-18:1_22:6)", "PE(P-20:1_22:6)",  "LPE(18:1)", "LPE(16:1)_2", "LPE(18:1)_2", "LPE(20:0)_2", "LPE(22:4)_2",  "PG(14:0_15:0)", "PG(14:0_16:1)", "PG(16:0_16:1)", "PG(16:1_16:1)",  "PG(14:0_18:0)", "PG(18:0_18:0)", "PG(16:1_18:1)", "PG(18:0_18:1)",  "PG(18:1_18:1)", "PG(16:0_18:2)", "PG(18:1_18:2)", "PG(18:2_18:2)",  "PG(16:0_20:0)", "PG(16:1_20:0)", "PG(18:1_20:0)", "PG(18:2_20:0)",  "PG(20:0_20:0)", "PG(16:1_20:1)", "PG(18:0_20:1)", "PG(20:1_20:2)",  "PG(16:0_20:3)", "PG(18:0_20:3)", "PG(20:0_20:3)", "PG(20:1_20:3)",  "PG(20:4_20:4)", "PG(16:1_20:5)", "PG(18:0_20:5)", "PG(18:1_20:5)",  "PG(20:1_20:5)", "PG(20:4_20:5)", "PG(14:0_22:4)", "PG(18:1_22:4)",  "PG(18:2_22:4)", "PG(18:3_22:4)", "PG(20:3_22:4)", "PG(20:4_22:4)",  "PG(22:4_22:4)", "PG(18:0_22:5)", "PG(18:1_22:5)", "PG(20:3_22:5)",  "PG(22:4_22:5)", "PG(14:0_22:6)", "PG(16:0_22:6)", "PG(16:1_22:6)",  "PG(18:0_22:6)", "PG(18:1_22:6)", "PG(18:2_22:6)", "PG(18:3_22:6)",  "PG(20:0_22:6)", "PG(20:2_22:6)", "PG(22:4_22:6)", "PG(22:6_22:6)",  "LPG(16:0)", "LPG(18:0)", "LPG(18:2)", "LPG(16:0)_2", "LPG(18:2)_2",  "LPG(20:0)_2", "PI(14:0_16:0)", "PI(16:0_18:0)", "PI(16:1_18:0)",  "PI(18:0_18:0)", "PI(16:0_18:1)", "PI(18:0_18:1)", "PI(18:1_18:1)",  "PI(14:0_18:2)", "PI(16:0_18:2)", "PI(18:1_18:2)", "PI(18:2_18:2)",  "PI(18:1_20:0)", "PI(18:2_20:0)", "PI(18:3_20:0)", "PI(18:3_20:3)",  "PI(14:0_22:4)", "PI(18:2_22:4)", "LPI(14:0)", "LPI(16:0)", "LPI(16:1)",  "LPI(20:5)", "LPI(16:0)_2", "LPI(16:1)_2", "LPI(20:5)_2", "PS(18:0_18:0)",  "PS(16:1_18:1)", "CER(d18:1/22:0)", "CER(d18:1/24:0)", "GlcCer(d18:0/16:0)",  "GlcCer(d18:1/16:0)", "GlcCer(d18:0/20:0)", "GlcCer(d18:0/22:0)",  "GlcCer(d18:1/22:0)", "GlcCer(d18:0/24:0)", "GlcCer(d18:1/24:0)",  "SM(d18:1/14:0)", "SM(d18:1/18:1)", "SM(d18:1/20:0)", "DAG(18:2_18:2)",  "DAG(14:0_18:3)", "DAG(18:0_20:4)", "TAG(40:0_FA14:0)", "TAG(40:0_FA16:0)",  "TAG(54:5_FA18:1)", "TAG(56:5_FA20:1)", "TAG(52:2_FA20:2)")
Group <- c("PC", "PC", "PC", "PC", "PC", "PC", "PC", "PC", "PC", "PC",  "PC", "PC", "PC", "PC", "PC", "PC", "PC", "PC", "PC", "PC", "PC",  "PC", "PC", "PC", "PC", "PC", "PC", "PC", "PC", "PC", "PC", "PC",  "PC", "PC", "PC", "PC", "PC", "PC", "PC", "PC", "Lyso_PC", "Lyso_PC",  "Lyso_PC", "Lyso_PC", "Lyso_PC", "Lyso_PC", "Lyso_PC", "Lyso_PC",  "Lyso_PC", "Lyso_PC", "Lyso_PC", "Lyso_PC", "Lyso_PC", "Lyso_PC",  "Lyso_PC", "Lyso_PC", "Lyso_PC", "Lyso_PC", "Lyso_PC", "Lyso_PC",  "Lyso_PC", "Lyso_PC", "Lyso_PC", "Lyso_PC", "PE", "PE", "PE",  "PE", "PE", "PE", "PE", "PE", "PE", "PE", "PE", "PE", "PE", "PE",  "PE", "PE", "PE", "PE", "PE", "PE", "PE", "PE", "PE", "PE", "PE",  "PE", "PE", "PE", "PE", "Lyso_PE", "Lyso_PE", "Lyso_PE", "Lyso_PE",  "Lyso_PE", "PG", "PG", "PG", "PG", "PG", "PG", "PG", "PG", "PG",  "PG", "PG", "PG", "PG", "PG", "PG", "PG", "PG", "PG", "PG", "PG",  "PG", "PG", "PG", "PG", "PG", "PG", "PG", "PG", "PG", "PG", "PG",  "PG", "PG", "PG", "PG", "PG", "PG", "PG", "PG", "PG", "PG", "PG",  "PG", "PG", "PG", "PG", "PG", "PG", "PG", "PG", "PG", "PG", "Lyso_PG",  "Lyso_PG", "Lyso_PG", "Lyso_PG", "Lyso_PG", "Lyso_PG", "PI",  "PI", "PI", "PI", "PI", "PI", "PI", "PI", "PI", "PI", "PI", "PI",  "PI", "PI", "PI", "PI", "PI", "Lyso_PI", "Lyso_PI", "Lyso_PI",  "Lyso_PI", "Lyso_PI", "Lyso_PI", "Lyso_PI", "PS", "PS", "Sphingo",  "Sphingo", "Sphingo", "Sphingo", "Sphingo", "Sphingo", "Sphingo",  "Sphingo", "Sphingo", "Sphingo", "Sphingo", "Sphingo", "Neutral",  "Neutral", "Neutral", "Neutral", "Neutral", "Neutral", "Neutral",  "Neutral")
Acyl_1 <- c("C14:0", "C14:0", "C14:0", "C16:1", "C18:0", "C14:0", "C16:1",  "C18:0", "C18:1", "C16:0", "C18:0", "C18:1", "C18:2", "C16:0",  "C18:1", "C18:1", "C16:0", "C18:2", "C18:0", "C18:1", "C20:1",  "C18:0", "C18:2", "C20:1", "C20:2", "C16:0", "C18:0", "C16:0",  "C20:0", "C18:0", "C16:0", "C18:0", "C18:1", "C16:0", "C18:0",  "C16:0", "C16:0", "C18:1", "C20:1", "C18:0", "C14:0", "C15:0",  "C16:0", "C16:1", "C18:0", "C18:1", "C18:2", "C20:0", "C20:1",  "C20:3", "C20:4", "C22:6", "N/A", "N/A", "N/A", "N/A", "N/A",  "N/A", "N/A", "N/A", "N/A", "N/A", "N/A", "N/A", "C16:0", "C18:0",  "C18:1", "C18:2", "C16:0", "C18:2", "C16:0", "C20:2", "C16:0",  "C18:0", "C18:1", "C16:0", "C18:0", "C18:2", "C18:0", "C16:0",  "C18:0", "C18:1", "C16:0", "C18:0", "C16:0", "C18:0", "C18:1",  "C20:0", "C20:1", "C16:0", "C18:0", "C18:1", "C20:1", "C18:1",  "N/A", "N/A", "N/A", "N/A", "C14:0", "C14:0", "C16:0", "C16:1",  "C14:0", "C18:0", "C16:1", "C18:0", "C18:1", "C16:0", "C18:1",  "C18:2", "C16:0", "C16:1", "C18:1", "C18:2", "C20:0", "C16:1",  "C18:0", "C20:1", "C16:0", "C18:0", "C20:0", "C20:1", "C20:4",  "C16:1", "C18:0", "C18:1", "C20:1", "C20:4", "C14:0", "C18:1",  "C18:2", "C18:3", "C20:3", "C20:4", "C22:4", "C18:0", "C18:1",  "C20:3", "C22:4", "C14:0", "C16:0", "C16:1", "C18:0", "C18:1",  "C18:2", "C18:3", "C20:0", "C20:2", "C22:4", "C22:6", "C16:0",  "C18:0", "C18:2", "N/A", "N/A", "N/A", "C14:0", "C16:0", "C16:1",  "C18:0", "C16:0", "C18:0", "C18:1", "C14:0", "C16:0", "C18:1",  "C18:2", "C18:1", "C18:2", "C18:3", "C18:3", "C14:0", "C18:2",  "C14:0", "C16:0", "C16:1", "C20:5", "N/A", "N/A", "N/A", "C18:0",  "C16:1", "d18:1", "d18:1", "d18:0", "d18:1", "d18:0", "d18:0",  "d18:1", "d18:0", "d18:1", "d18:1", "d18:1", "d18:1", "C18:2",  "C14:0", "C18:0", "C14:0", "C16:0", "C18:1", "C20:1", "C20:2" )
Acyl_2 <- c("C14:0", "C16:0", "C18:0", "C18:0", "C18:0", "C18:1", "C18:1",  "C18:1", "C18:1", "C18:2", "C18:2", "C18:2", "C18:2", "C18:3",  "C20:0", "C20:1", "C20:2", "C20:2", "C20:3", "C20:3", "C20:3",  "C20:4", "C20:4", "C20:4", "C20:4", "C20:5", "C20:5", "C22:4",  "C22:4", "C22:5", "C22:6", "C22:6", "C22:6", "C18:2", "C18:2",  "C22:4", "C22:6", "C16:0", "C20:4", "C22:6", "N/A", "N/A", "N/A",  "N/A", "N/A", "N/A", "N/A", "N/A", "N/A", "N/A", "N/A", "N/A",  "C14:0", "C15:0", "C16:0", "C16:1", "C18:0", "C18:1", "C20:0",  "C20:1", "C20:2", "C20:3", "C20:4", "C22:5", "C18:2", "C18:2",  "C18:2", "C18:2", "C20:2", "C20:2", "C20:4", "C20:4", "C22:4",  "C22:4", "C22:4", "C22:5", "C22:6", "C22:6", "C18:2", "C22:4",  "C22:4", "C20:2", "C20:5", "C20:5", "C22:4", "C22:4", "C22:4",  "C22:4", "C22:4", "C22:6", "C22:6", "C22:6", "C22:6", "N/A",  "C16:1", "C18:1", "C20:0", "C22:4", "C15:0", "C16:1", "C16:1",  "C16:1", "C18:0", "C18:0", "C18:1", "C18:1", "C18:1", "C18:2",  "C18:2", "C18:2", "C20:0", "C20:0", "C20:0", "C20:0", "C20:0",  "C20:1", "C20:1", "C20:2", "C20:3", "C20:3", "C20:3", "C20:3",  "C20:4", "C20:5", "C20:5", "C20:5", "C20:5", "C20:5", "C22:4",  "C22:4", "C22:4", "C22:4", "C22:4", "C22:4", "C22:4", "C22:5",  "C22:5", "C22:5", "C22:5", "C22:6", "C22:6", "C22:6", "C22:6",  "C22:6", "C22:6", "C22:6", "C22:6", "C22:6", "C22:6", "C22:6",  "N/A", "N/A", "N/A", "C16:0", "C18:2", "C20:0", "C16:0", "C18:0",  "C18:0", "C18:0", "C18:1", "C18:1", "C18:1", "C18:2", "C18:2",  "C18:2", "C18:2", "C20:0", "C20:0", "C20:0", "C20:3", "C22:4",  "C22:4", "N/A", "N/A", "N/A", "N/A", "C16:0", "C16:1", "C20:5",  "C18:0", "C18:1", "C22:0", "C24:0", "C16:0", "C16:0", "C20:0",  "C22:0", "C22:0", "C24:0", "C24:0", "C14:0", "C18:1", "C20:0",  "C18:2", "C18:3", "C20:4", "N/A", "N/A", "N/A", "N/A", "N/A")

Group_levels <- c("PC", "Lyso_PC", "PE", "Lyso_PE",  "PG", "Lyso_PG", "PI", "Lyso_PI", "PS", "Sphingo", "Neutral")

# effect sizes
effect_size <- c(PC = 0.66, Lyso_PC = 0.85, PE = 0.71, Lyso_PE = 0.6, PG = 0.54, Lyso_PG = 0.49, PI = 0.41, Lyso_PI = 0.4, PS = 0.46, Sphingo = 0.53, Neutral = 0.71)

# sample effect mod
sample_effect <- c(A = 0.7, B = 0.9, C = 1.1, D = 1.3)

# generate data
set.seed(293847)
metlip <- 
  tibble(Lipid = rep(example_lipids, 4),
         Group = rep(Group, 4) |> factor(levels = Group_levels),
         Acyl_1 = rep(Acyl_1, 4),
         Acyl_2 = rep(Acyl_2, 4),
         sample = rep(c('A', 'B', 'C', 'D'), each = length(example_lipids)),
         log2FC = (rgamma(length(sample), effect_size[Group] * sample_effect[sample] - 0.2, 3) + 0.2) * ifelse(rbinom(length(sample), 1, 0.5), 1, -1),
         neg_log_p = 1.6 + rgamma(length(sample), 1.6*abs(log2FC)))

# throw in some missingness (~5%) with larger log2FC values being less likely to be dropped
drop <- sample(1:nrow(metlip), size = 40, prob = 1/abs(metlip$log2FC))

metlip <- metlip[-drop, ]

usethis::use_data(metlip, overwrite = TRUE)